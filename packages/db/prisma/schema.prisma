generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  MEMBER  
  ADMIN
}

model User {
  id             String         @id @default(uuid())
  email          String         @unique     
  password       String    
  name           String
  photo          String?
  
  chats                 Chat[]
  adminOfRooms          Room[]   @relation("RoomAdmin")
  roomMemberships       RoomMember[] 

}

//Workspace room
model Room {
  id             Int           @id @default(autoincrement())
  slug           String        @unique      //Room Name
  createdAt      DateTime      @default(now())
  adminId        String  

  chats          Chat[]
  admin          User          @relation( "RoomAdmin", fields: [adminId], references: [id])
  members       RoomMember[] 
 
}


model Chat{
  id              Int          @id @default(autoincrement())
  message         String   
  roomId          Int   
  userId          String

  user            User         @relation(fields: [userId], references: [id])
  room            Room         @relation(fields: [roomId], references: [id])
}
 
 model RoomMember{
  id          Int       @id @default(autoincrement())
  userId      String    
  roomId      Int
  role        Role      //Admin or  Member

  room        Room      @relation(fields: [roomId], references: [id])
  user        User      @relation(fields: [userId],references: [id])

  @@unique([userId, roomId])
 }